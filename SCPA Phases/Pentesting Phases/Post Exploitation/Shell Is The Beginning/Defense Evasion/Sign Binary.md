# Sign Binary

## 01 - Sysinternals

`C:\> makecert.exe -r -pe -n "CN=Microsoft" -ss CA -sr CurrentUser -a sha256 -cy authority -sky signature -sv MicrosoftCA.pvk MicrosoftCA.cer`

`C:\> certutil.exe -user -addstore Root MicrosoftCA.cer`

`C:\> makecert.exe -pe -n "CN=Microsoft Cert" -a sha256 -cy end -sky signature -ic MicrosoftCA.cer -iv MicrosoftCA.pvk -sv MicrosoftCert.pvk MicrosoftCert.cer`

`C:\> pvk2pfx.exe -pvk MicrosoftCert.pvk -spc MicrosoftCert.cer -pfx MicrosoftCert.pfx`

`C:\> signtool.exe sign /v /f MicrosoftCert.pfx /t http://timestamp.digicert.com/?alg=sha1 <payload_name>`

`C:\> signtool.exe sign /fd sha256 /a /tr http://timestamp.digicert.com <payload_name>`

## References

- [LazySign](https://github.com/jfmaes/LazySign)