# Kernel

## 01 - Manual

### 1.1 - Command Prompt

- **Enumerating the system to see any kind of potential version we can take over**

`C:\> systeminfo`

`C:\> systeminfo | findstr /b /c:"OS Name" /c:"OS Version"`

`C:\> ver`

`C:\> wmic computersystem list full`

`C:\> type C:\Windows\system32\eula.txt`

`C:\> type c:\windows\WindowsUpdate.log`

`C:\> wmic qfe`

`C:\> wmic qfe get caption,description,hotfixid,installedon`

`C:\> wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:"KB4012212" /C:"KB4012215"`

### 1.2 - Powershell

- **Enumerating the system to see any kind of potential version we can take over**

`PS C:\> [System.Environment]::OSVersion.Version`

`PS C:\> Get-CimInstance Win32_OperatingSystem`

`PS C:\> Get-Hotfix`

`PS C:\> Get-CimInstance -Classname Win32_QuickFixEngineering`

## 02 - Impacket

`$ wmiquery.py <domain_name>/<username>:<password>@<IP>`

`$ wmiquery.py <domain_name>/<username>@<IP> -hashes :<nt_hash>`

`WQL> SELECT Caption FROM win32_operatingsystem`

## 03 - Metasploit

`meterpreter > sysinfo`

## References

- [List Security Patches](https://support.moonpoint.com/os/windows/PowerShell/list-security-patches/)