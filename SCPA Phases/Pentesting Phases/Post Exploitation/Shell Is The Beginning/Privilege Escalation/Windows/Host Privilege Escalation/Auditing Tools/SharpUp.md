# SharpUp

## 01 - Compile

- **Install a targeting pack**

https://dotnet.microsoft.com/en-us/download/dotnet-framework/net481

- **Compile SharpUp**

```
C:\> git clone https://github.com/GhostPack/SharpUp

C:\> cd SharpUp

C:\SharpUp> dotnet build -c Release -p:TargetFrameworkVersion=v4.8.1
```

## 02 - Manual

### 2.1 - Help Menu

```
C:\> SharpUp.exe

SharpUp.exe [audit] [check1] [check2]...

    audit   - Specifies whether or not to enable audit mode. If enabled, SharpUp will run vulenrability checks
              regardless if the process is in high integrity or the user is in the local administrator's group.
              If no checks are specified, audit will run all checks. Otherwise, each check following audit will
              be ran.

    check*  - The individual vulnerability check to be ran. Must be one of the following:

              - AlwaysInstallElevated
              - CachedGPPPassword
              - DomainGPPPassword
              - HijackablePaths
              - McAfeeSitelistFiles
              - ModifiableScheduledTaskFile
              - ModifiableServiceBinaries
              - ModifiableServiceRegistryKeys
              - ModifiableServices
              - ProcessDLLHijack
              - RegistryAutoLogons
              - RegistryAutoruns
              - TokenPrivileges
              - UnattendedInstallFiles
              - UnquotedServicePath



    Examples:
        SharpUp.exe audit
            -> Runs all vulnerability checks regardless of integrity level or group membership.

        SharpUp.exe HijackablePaths
            -> Check only if there are modifiable paths in the user's %PATH% variable.

        SharpUp.exe audit HijackablePaths
            -> Check only for modifiable paths in the user's %PATH% regardless of integrity level or group membership.
```

### 2.2 - Usage

- **Check every vulnerability regardless of the integrity level or group membership**

`C:\> SharpUp.exe audit`

- **Auditing any vulnerable services**

`C:\> SharpUp.exe audit AlwaysInstallElevated HijackablePaths ModifiableServiceBinaries ModifiableServices UnquotedServicePath`

- **Enumerate weak registry values**

`C:\> SharpUp.exe audit RegistryAutoLogons RegistryAutoruns ModifiableServiceRegistryKeys`

- **Find SiteList.xml file**

`C:\> SharpUp.exe audit McAfeeSitelistFiles`

- **Find the group policy XML files**

`C:\> SharpUp.exe audit CachedGPPPassword DomainGPPPassword`

- **Perform a check of Token Impersonation**

`C:\> SharpUp.exe audit TokenPrivileges`

## References

- [SharpUp](https://github.com/GhostPack/SharpUp)